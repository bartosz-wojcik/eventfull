{% block content  %}

{% include "message.html" %}

<table class="table table-striped table-bordered" style="text-align:center; margin-top: 10px;">
    {% if type == 'promoter'  %}
    <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Venue</th>
        <th>Performers</th>
        <th>Ticket Price</th>
        <th>Start Date</th>
        <th>End Date</th>
    </tr>
    {% for item in events %}
    <tr>
        <td>{{ item.name }}</td>
        <td>{{ item.description }}</td>
        <td>{{ item.venue_name }}</td>
        <td>{{ item.performer_names }}</td>
        <td>{{ item.ticket_price }}</td>
        <td>{{ item.start_date }}</td>
        <td>{{ item.end_date }}</td>
        <td><a href="edit_event/{{ item.pk }}" >Edit</a></td>
        <td><a href="delete_event/{{ item.pk }}" >Delete</a></td>
    </tr>
    {% endfor %}
    {% endif %}

    {% if type == 'user'  %}
    <tr>
        <th>Event</th>
        <th>Description</th>
        <th>Venue</th>
        <th>Performers</th>
        <th>Category</th>
        <th>Type</th>
        <th>Start Date</th>
        <th>End Date</th>
    </tr>
    {% for item in events %}
    <tr>
        <td>{{ item.name }}</td>
        <td>{{ item.description }}</td>
        <td>{{ item.venue_name }}</td>
        <td>{{ item.performer_names }}</td>
        <td>{{ item.category.name }}</td>

        {% if item.event_type == 'f'  %}
        <td>Free</td>
        {% else %}
        <td>Buy tickets</td>
        {% endif %}

        <td>{{ item.start_date }}</td>
        <td>{{ item.end_date }}</td>

        {% if user.is_authenticated %}
        <td><a href="#" event="{{ item.pk }}" id="wishlist-{{ item.pk }}" type="like">Like</a></td>
         {% endif  %}
    </tr>
    {% endfor %}
    {% endif %}
</table>

<script>
    $(document).ready(function(){

      $('table a').click(function(){

            if($(this).attr("type") == "like"){
             item = $(this)
              $.ajax({
            type: 'GET',
            url: "{% url 'like_event' %}",
            data: {"id": $(this).attr("event")},
            success: function (response) {
            item.closest("tr").remove();
            },
            error: function (response) {
                console.log(response)
            }
        })
            }
      })

    });
</script>
{% endblock  %}

